# ğŸ›¡ï¸ Fraud Detection System - Flow Diagram

## ğŸ“Š System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER MAKES REQUEST                               â”‚
â”‚                   (Payment / Bid / Profile Change)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRAUD DETECTION MIDDLEWARE                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  1. Capture request data (IP, device, location, amount, etc.)    â”‚  â”‚
â”‚  â”‚  2. Check user authentication                                     â”‚  â”‚
â”‚  â”‚  3. Skip check if user is admin                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     FRAUD ANALYSIS ENGINE                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Route-Specific Analysis:                                         â”‚  â”‚
â”‚  â”‚  â€¢ Payment â†’ analyzePaymentRequest()                              â”‚  â”‚
â”‚  â”‚  â€¢ Profile â†’ analyzeProfileRequest()                              â”‚  â”‚
â”‚  â”‚  â€¢ Bid     â†’ analyzeBidRequest()                                  â”‚  â”‚
â”‚  â”‚  â€¢ Project â†’ analyzeProjectRequest()                              â”‚  â”‚
â”‚  â”‚  â€¢ Message â†’ analyzeMessageRequest()                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                      â”‚                             â”‚
                      â–¼                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  REAL-TIME CHECKS       â”‚   â”‚  HISTORICAL ANALYSIS    â”‚
        â”‚  â”œâ”€ Velocity limits     â”‚   â”‚  â”œâ”€ Payment patterns   â”‚
        â”‚  â”œâ”€ Amount thresholds   â”‚   â”‚  â”œâ”€ Account behavior   â”‚
        â”‚  â”œâ”€ Rate limiting       â”‚   â”‚  â”œâ”€ Transaction trends â”‚
        â”‚  â”œâ”€ IP validation       â”‚   â”‚  â”œâ”€ Device history     â”‚
        â”‚  â””â”€ Device fingerprint  â”‚   â”‚  â””â”€ Geographic patternsâ”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚                             â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     CALCULATE RISK SCORE (0-100)      â”‚
              â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
              â”‚  â”‚  Weighted average of:           â”‚  â”‚
              â”‚  â”‚  â€¢ Payment behavior score       â”‚  â”‚
              â”‚  â”‚  â€¢ Account behavior score       â”‚  â”‚
              â”‚  â”‚  â€¢ Transaction pattern score    â”‚  â”‚
              â”‚  â”‚  â€¢ Device behavior score        â”‚  â”‚
              â”‚  â”‚  â€¢ Geographic anomaly score     â”‚  â”‚
              â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚      DETERMINE ACTION BASED ON        â”‚
              â”‚           RISK LEVEL                  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚             â”‚           â”‚           â”‚             â”‚
        â–¼             â–¼           â–¼           â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  0-29  â”‚   â”‚  30-49  â”‚  â”‚50-69 â”‚  â”‚  70-89   â”‚  â”‚  90-100  â”‚
   â”‚MINIMAL â”‚   â”‚   LOW   â”‚  â”‚MEDIUMâ”‚  â”‚   HIGH   â”‚  â”‚ CRITICAL â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚           â”‚          â”‚             â”‚
        â–¼            â–¼           â–¼          â–¼             â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ALLOW  â”‚   â”‚ ALLOW + â”‚  â”‚ALLOW+â”‚  â”‚ REQUIRE  â”‚  â”‚  BLOCK   â”‚
   â”‚REQUEST â”‚   â”‚   LOG   â”‚  â”‚ FLAG â”‚  â”‚  VERIFY  â”‚  â”‚ REQUEST  â”‚
   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
        â”‚            â”‚           â”‚          â”‚             â”‚
        â”‚            â”‚           â–¼          â”‚             â”‚
        â”‚            â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚             â”‚
        â”‚            â”‚      â”‚CREATE ALERTâ”‚  â”‚             â”‚
        â”‚            â”‚      â”‚(Notification)â”‚  â”‚             â”‚
        â”‚            â”‚      â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚             â”‚
        â”‚            â”‚             â”‚        â”‚             â”‚
        â”‚            â–¼             â–¼        â–¼             â–¼
        â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚     â”‚       LOG TO AUDIT TRAIL                      â”‚
        â”‚     â”‚  (ImmutableAuditLog + UserBehaviorAnalytics) â”‚
        â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚     HIGH/CRITICAL RISK DETECTED?      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚                   â”‚
                       YES                 NO
                        â”‚                   â”‚
                        â–¼                   â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  CREATE FRAUD CASE        â”‚   â”‚   CONTINUE   â”‚
        â”‚  â”œâ”€ Assign case ID        â”‚   â”‚   REQUEST    â”‚
        â”‚  â”œâ”€ Collect evidence      â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚  â”œâ”€ Set status: investigatingâ”‚
        â”‚  â”œâ”€ Calculate financial impactâ”‚
        â”‚  â””â”€ Notify admin team     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  ADMIN FRAUD DASHBOARD        â”‚
        â”‚  â”œâ”€ View active cases         â”‚
        â”‚  â”œâ”€ Review alerts             â”‚
        â”‚  â”œâ”€ Investigate evidence      â”‚
        â”‚  â”œâ”€ Take action:              â”‚
        â”‚  â”‚  â€¢ Suspend account         â”‚
        â”‚  â”‚  â€¢ Request verification    â”‚
        â”‚  â”‚  â€¢ Mark false positive     â”‚
        â”‚  â”‚  â€¢ Resolve case            â”‚
        â”‚  â””â”€ Update case notes         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Detection Rule Flow

```
USER ACTION
    â”‚
    â–¼
CHECK ACTIVE RULES (by priority)
    â”‚
    â”œâ”€â–º Rule 1: Payment Velocity
    â”‚   â””â”€â–º 3+ payments in 5 min? â†’ TRIGGERED (Score: 75)
    â”‚
    â”œâ”€â–º Rule 2: High Value Transaction
    â”‚   â””â”€â–º Amount > 3x average? â†’ TRIGGERED (Score: 60)
    â”‚
    â”œâ”€â–º Rule 3: Email Change
    â”‚   â””â”€â–º Email changed? â†’ TRIGGERED (Score: 85)
    â”‚
    â””â”€â–º ... (14 total rules)
    â”‚
    â–¼
AGGREGATE SCORES
    â”‚
    â”œâ”€â–º Highest score wins
    â”œâ”€â–º Apply severity level
    â””â”€â–º Execute associated action
    â”‚
    â–¼
TAKE ACTION
    â”œâ”€â–º require_verification
    â”œâ”€â–º manual_review
    â”œâ”€â–º rate_limit
    â”œâ”€â–º block
    â”œâ”€â–º monitor
    â””â”€â–º allow
```

---

## ğŸ”„ Alert Lifecycle

```
1. TRIGGER
   â†“
   Detection rule triggered
   Risk score calculated
   
2. CREATE
   â†“
   FraudDetectionAlert created
   Status: active
   Severity: low/medium/high/critical
   
3. NOTIFY
   â†“
   Email sent to admins (if high/critical)
   Dashboard notification
   SMS (if critical)
   
4. REVIEW
   â†“
   Admin views alert
   Reviews evidence
   Investigates user activity
   
5. RESOLVE
   â†“
   Action taken:
   â€¢ Confirmed fraud â†’ Create case
   â€¢ False positive â†’ Mark & dismiss
   â€¢ Suspicious â†’ Continue monitoring
   â€¢ Resolved â†’ Close alert
```

---

## ğŸ¨ Risk Score Calculation

```
Payment Behavior (0-100)
   â”œâ”€ Velocity: 40 points
   â”œâ”€ Amount anomaly: 30 points
   â””â”€ Failed attempts: 25 points
        â”‚
        â–¼
Account Behavior (0-100)
   â”œâ”€ Profile changes: 35 points
   â”œâ”€ Email changes: 50 points
   â””â”€ Password resets: 30 points
        â”‚
        â–¼
Transaction Patterns (0-100)
   â”œâ”€ Amount anomaly: 45 points
   â””â”€ Round numbers: 25 points
        â”‚
        â–¼
Device Behavior (0-100)
   â”œâ”€ Multiple fingerprints: 40 points
   â””â”€ User agent changes: 30 points
        â”‚
        â–¼
Geographic Behavior (0-100)
   â”œâ”€ Location mismatch: 60 points
   â””â”€ IP changes: 35 points
        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º WEIGHTED AVERAGE
                            â”‚
                            â–¼
                    OVERALL RISK SCORE
                        (0-100)
                            â”‚
                            â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚                     â”‚
         0-29: Minimal          90-100: Critical
         30-49: Low            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
         50-69: Medium         â”‚                 â”‚
         70-89: High       SUSPEND           BLOCK
                           ACCOUNT          REQUEST
```

---

## ğŸš¨ Response Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RISK LEVEL   â”‚ AUTO ACTION â”‚ ADMIN NOTIFIED â”‚ USER EXPERIENCE â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Minimal      â”‚ Allow       â”‚ No             â”‚ Normal          â”‚
â”‚ (0-29)       â”‚             â”‚                â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Low          â”‚ Allow + Log â”‚ No             â”‚ Normal          â”‚
â”‚ (30-49)      â”‚             â”‚                â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Medium       â”‚ Flag + Log  â”‚ Email (digest) â”‚ Slight delay    â”‚
â”‚ (50-69)      â”‚             â”‚                â”‚                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ High         â”‚ Verify ID   â”‚ Instant email  â”‚ Extra step      â”‚
â”‚ (70-89)      â”‚             â”‚                â”‚ required        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Critical     â”‚ Block       â”‚ Email + SMS    â”‚ Request blocked â”‚
â”‚ (90-100)     â”‚             â”‚                â”‚ Account review  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Data Flow

```
REQUEST DATA
    â”œâ”€â–º IP Address
    â”œâ”€â–º User Agent
    â”œâ”€â–º Device Fingerprint
    â”œâ”€â–º Request payload
    â”œâ”€â–º Timestamp
    â””â”€â–º Session data
        â”‚
        â–¼
FRAUD DETECTION SERVICE
        â”‚
        â”œâ”€â–º Database queries
        â”‚   â”œâ”€ User history
        â”‚   â”œâ”€ Transaction patterns
        â”‚   â””â”€ Audit logs
        â”‚
        â”œâ”€â–º External services
        â”‚   â”œâ”€ IP geolocation
        â”‚   â”œâ”€ Stripe Radar (optional)
        â”‚   â””â”€ ML model (future)
        â”‚
        â””â”€â–º Cache
            â”œâ”€ User risk scores
            â””â”€ Detection results
        â”‚
        â–¼
DECISION ENGINE
        â”‚
        â”œâ”€â–º Allow request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Continue
        â”œâ”€â–º Require verification â”€â”€â”€â”€â”€â”€â–º Extra step
        â””â”€â–º Block request â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Error 403
        â”‚
        â–¼
LOGGING & ANALYTICS
        â”œâ”€â–º ImmutableAuditLog
        â”œâ”€â–º UserBehaviorAnalytics
        â”œâ”€â–º FraudDetectionAlert
        â””â”€â–º FraudDetectionCase (if needed)
```

---

## ğŸ¯ Quick Reference

### Risk Scores:
- **0-29:** âœ… Minimal - Normal operation
- **30-49:** âš ï¸ Low - Enhanced logging
- **50-69:** ğŸŸ¡ Medium - Flagged for review
- **70-89:** ğŸŸ  High - Verification required
- **90-100:** ğŸ”´ Critical - Request blocked

### Actions:
- **allow** - Process normally
- **monitor** - Log and continue
- **rate_limit** - Slow down requests
- **require_verification** - Extra identity check
- **manual_review** - Admin must review
- **block** - Deny request immediately

### Severities:
- **low** - Informational
- **medium** - Should review
- **high** - Urgent review
- **critical** - Immediate action

---

**This visual guide helps you understand how the fraud detection system works end-to-end!** ğŸš€
